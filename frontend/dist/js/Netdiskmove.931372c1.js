(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Netdiskmove"],{b90a:function(t,e,i){},bb43:function(t,e,i){"use strict";i("b90a")},bddd:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"netdisk"},[s("div",{staticClass:"head"},[s("van-nav-bar",{attrs:{title:"选择您要移动到的目录","left-text":"返回","right-text":"确定","left-arrow":""},on:{"click-left":function(e){return t.$router.push("/netdisk")},"click-right":t.determine},scopedSlots:t._u([{key:"right",fn:function(){},proxy:!0}])})],1),s("div",{staticClass:"path"},[s("p",[s("span",{staticClass:"backon",class:{isbackon:t.isBackon},on:{click:t.backOn}},[t._v("返回上一层：")]),s("span",{staticClass:"pathnow"},[t._v(" "+t._s(t.path)+" ")])])]),s("div",{staticClass:"main"},t._l(t.dir,(function(e,a){return s("div",{key:-a-1,staticClass:"files"},[s("p",{staticClass:"file",on:{click:function(i){return t.getInto(e)}}},[s("img",{attrs:{src:i("c7bd"),alt:""}})]),s("p",{staticClass:"fileName",on:{click:function(i){return t.getInto(e)}}},[t._v(" "+t._s(e)+" ")]),s("p",{staticClass:"fileMenu",on:{click:t.setDir}},[s("span",{staticClass:"menu"},[t._v("···")])])])})),0),s("van-button",{staticClass:"createFile",attrs:{round:"",type:"info"},on:{click:t.createFile}},[s("span",{style:{color:"#fff"}},[t._v(" + ")])]),s("van-popup",{style:{height:"20%"},attrs:{round:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("p",{style:{textAlign:"center",fontSize:"1.2rem"}},[t._v("新建")]),s("div",{staticClass:"myNewFile",on:{click:t.createDir}},[s("div",{staticClass:"newlyBuild"},[s("van-icon",{staticClass:"ico",attrs:{name:"card"}}),s("p",[t._v("文件夹")])],1)])]),s("van-popup",{style:{height:"100%",backgroundColor:"#454545"},attrs:{closeable:"","close-icon-position":"top-left",position:"bottom"},model:{value:t.createDirShow,callback:function(e){t.createDirShow=e},expression:"createDirShow"}},[s("div",{staticClass:"myNewFiles"},[s("div",{staticClass:"newlyBuilds"},[s("p",[t._v("新建文件夹")])])]),s("div",{staticClass:"inputDirName"},[s("p",{staticClass:"inputDirNameImage"},[s("img",{attrs:{src:i("c7bd"),alt:""}})]),s("p",{staticClass:"input"},[s("van-cell-group",[s("van-field",{style:{borderRadius:"1rem"},attrs:{placeholder:"输入文件夹名称","input-align":"conter"},model:{value:t.dirName,callback:function(e){t.dirName=e},expression:"dirName"}})],1)],1),s("p",{staticClass:"btnConfirm"},[s("van-button",{attrs:{plain:"",hairline:"",type:"info"},on:{click:t.confirmCreateFile}},[t._v("确认")])],1)])]),s("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.rmDirShow,callback:function(e){t.rmDirShow=e},expression:"rmDirShow"}},[s("p",{staticClass:"setFileName"},[t._v(" "+t._s(t.setDirArr[0])+" ")]),s("p",{staticClass:"rmDirs"},[t._v("重命名")]),s("p",{staticClass:"rmDirs",on:{click:t.delDir}},[t._v("删除")])])],1)},a=[],o={name:"Netdisk",data(){return{path:"/",dir:[],download:[],setDirArr:[],backonStr:0,code:"0",message:"",dirName:"",userId:"",filemovepath:"",show:!1,createDirShow:!1,rmDirShow:!1,isBackon:!1,fontWeight:!0,oldfilepath:""}},mounted(){this.oldfilepath=localStorage.getItem("oldfilepath"),localStorage.removeItem("oldfilepath"),this.rander()},methods:{rander(){this.Toast.loading({message:"",forbidClick:!0,duration:1e4}),this.$axios.post({url:"netdisk/readfile",data:{pathnow:this.path}}).then(t=>{this.Toast.clear(),t&&0==t.code?(this.download=t.file.sort(),this.dir=t.dir.sort(),this.userId=t.userId):(this.code=t.code,this.message=t.message)})},getInto(t){this.filemovepath="/"==this.path?this.path+t:this.path+"/"+t,this.backonStr++,this.backonStr>=0&&(this.isBackon=!0);let e="";e="/"==this.path?this.path+event.currentTarget.parentNode.children[1].textContent:this.path+"/"+event.currentTarget.parentNode.children[1].textContent,e=e.replace(/\s*/g,""),this.$axios.post({url:"netdisk/readfile",data:{pathnow:e}}).then(t=>{0==t.code?(this.download=t.file.sort(),this.dir=t.dir.sort(),this.path=e):(this.download=[],this.dir=[],this.path=e,this.code=t.code,this.message=t.message)})},backOn(){if(""==this.filemovepath)return;this.filemovepath=this.filemovepath.substr(0,this.filemovepath.lastIndexOf("/")),""==this.filemovepath&&(this.filemovepath="/"),this.backonStr--,this.backonStr<=0&&(this.isBackon=!1);let t="";"/"!=this.path?(t=this.path.substr(0,this.path.lastIndexOf("/")),""==t&&(t="/"),this.$axios.post({url:"netdisk/readfile",data:{pathnow:t}}).then(e=>{0==e.code?(this.download=e.file.sort(),this.dir=e.dir.sort(),this.path=t,this.code=e.code):(this.path=t,this.code=e.code,this.message=e.message)})):console.log("已达最上层目录")},createFile(){this.show=!0},createDir(){this.show=!1,this.createDirShow=!0},confirmCreateFile(){let t=this.dirName;if(t=t.match(/^[\u4E00-\u9FA5A-Za-z0-9]+/),null!=t){for(let e=0;e<this.dir.length;e++)this.dir[e]==t&&this.Toast.fail("文件名重复");this.$axios.post({url:"netdisk/createdir",data:{dirname:t,pathnow:this.path}}).then(e=>{0==e.code?(this.dir.unshift(t[0]),this.Toast.success("创建成功"),this.createDirShow=!1,this.rander(),this.code=e.code):(this.code=e.code,this.createDirShow=!1)}),this.dirName=""}else this.Toast.fail("文件命名不正确")},setDir(){let t=event.currentTarget.parentNode.children[1].textContent;this.setDirArr=[t],this.rmDirShow=!0},delDir(){this.Dialog.confirm({title:"删除此文件夹",message:"文件的历史版本将一并删除，确认是否将文件删除？"}).then(()=>{let t=this.setDirArr[0],e=this.path+"/"+t;e=e.replace(/\s*/g,""),this.$axios.post({url:"netdisk/delfile",data:{pathnow:e}}).then(t=>{0==t.code?(this.rmDirShow=!1,this.rander()):console.log(t.message)})})},determine(){localStorage.setItem("filemovepath",JSON.stringify({oldfilepath:this.oldfilepath,newfilepath:this.filemovepath})),this.$router.push("/netdisk")}}},r=o,n=(i("bb43"),i("2877")),l=Object(n["a"])(r,s,a,!1,null,"c55bd69e",null);e["default"]=l.exports},c7bd:function(t,e,i){t.exports=i.p+"img/文件.6b90fd60.png"}}]);
//# sourceMappingURL=Netdiskmove.931372c1.js.map