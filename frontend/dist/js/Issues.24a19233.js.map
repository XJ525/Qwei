{"version":3,"sources":["webpack:///./src/views/show/dyname/Issues.vue?e898","webpack:///./src/views/show/dyname/Issues.vue?dbbb","webpack:///src/views/show/dyname/Issues.vue","webpack:///./src/views/show/dyname/Issues.vue?1479","webpack:///./src/views/show/dyname/Issues.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","onClickLeft","scopedSlots","_u","key","fn","staticClass","onClickRight","_v","proxy","model","value","callback","$$v","expression","filefalse","showPopup","ref","vurl","style","height","show","afterRead","beforeRead","fileList","_e","afterRead2","beforeReadvideo","fileList2","staticRenderFns","name","filedata","filevideo","http","url","judgevideo","judgeprlic","props","type","String","methods","arr","file","length","console","log","$toast","fail","x","size","$router","push","path","$axios","status","message","formData","FormData","append","$refs","refvideo","zIndex","component"],"mappings":"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","file":"js/Issues.24a19233.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Issues.vue?vue&type=style&index=0&id=4e7e49ab&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"issues\"}},[_c('van-nav-bar',{attrs:{\"title\":\"分享\",\"left-text\":\"返回\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onClickLeft},scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('van-button',{staticClass:\"tit\",attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.onClickRight}},[_vm._v(\"发表\")])]},proxy:true}])}),_c('div',{staticClass:\"content\"},[_c('van-cell-group',{attrs:{\"rows\":\"5\"}},[_c('van-field',{staticClass:\"input_content\",attrs:{\"type\":\"textarea\",\"rows\":\"5\",\"maxlength\":\"200\",\"placeholder\":\"请输入你的内容\",\"spellcheck\":\"false\",\"show-word-limit\":\"\"},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}})],1),_c('van-uploader',{staticClass:\"fliefalse\",model:{value:(_vm.filefalse),callback:function ($$v) {_vm.filefalse=$$v},expression:\"filefalse\"}}),_c('van-cell',{staticClass:\"transfer\",on:{\"click\":_vm.showPopup}}),_c('div',{staticClass:\"videobox\"},[_c('video',{ref:\"refvideo\",attrs:{\"src\":_vm.vurl}})]),_c('van-popup',{style:({ height: '30%' }),attrs:{\"position\":\"bottom\"},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}},[(_vm.judgeprlic)?_c('van-uploader',{staticClass:\"jvideo\",attrs:{\"multiple\":\"\",\"max-count\":6,\"after-read\":_vm.afterRead,\"before-read\":_vm.beforeRead},model:{value:(_vm.fileList),callback:function ($$v) {_vm.fileList=$$v},expression:\"fileList\"}},[_c('van-cell-group',[_c('van-cell',{attrs:{\"center\":\"\"}},[_c('van-button',{staticClass:\"picktrue\",attrs:{\"type\":\"info\"}},[_vm._v(\"选择照片\")])],1)],1)],1):_vm._e(),(_vm.judgevideo)?_c('van-uploader',{staticClass:\"jvideo\",attrs:{\"after-read\":_vm.afterRead2,\"accept\":\"video/*\",\"before-read\":_vm.beforeReadvideo},model:{value:(_vm.fileList2),callback:function ($$v) {_vm.fileList2=$$v},expression:\"fileList2\"}},[_c('van-cell-group',[_c('van-cell',{attrs:{\"center\":\"\"}},[_c('van-button',{staticClass:\"picktrue\",attrs:{\"plain\":\"\",\"type\":\"info\"}},[_vm._v(\"上传视频\")])],1)],1)],1):_vm._e()],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"issues\">\n    <!-- 导航栏----------------------- -->\n    <van-nav-bar\n      title=\"分享\"\n      left-text=\"返回\"\n      left-arrow\n      @click-left=\"onClickLeft\"\n    >\n      <template #right>\n        <van-button type=\"primary\" size=\"mini\" @click=\"onClickRight\" class=\"tit\">发表</van-button>\n      </template>\n    </van-nav-bar>\n    <!-- 导航栏------------------------ -->\n\n    <div class=\"content\">\n\n      <!-- 输入框 ----------------------------------->\n      <van-cell-group rows=\"5\">\n        <van-field\n          type=\"textarea\"\n          rows=\"5\"\n          maxlength=\"200\"\n          v-model=\"value\"\n          placeholder=\"请输入你的内容\"\n          spellcheck='false'\n          show-word-limit\n          class=\"input_content\"\n        />\n      </van-cell-group>\n      <!-- 输入框 ---------------------------------->\n\n      <!-- 图片视频上传 ---------------------------->\n       <van-uploader \n        v-model=\"filefalse\" \n        class=\"fliefalse\"\n      />\n      <!-- 显示按钮组件 -->\n      <van-cell  @click=\"showPopup\" class=\"transfer\"></van-cell>\n\n      <!-- 显示视频 -->\n      <div class=\"videobox\"> \n          <video :src=\"vurl\"  ref=\"refvideo\"></video>\n      </div>\n\n\n      <!-- 视频图片点击事件 -->\n      <van-popup v-model=\"show\" position=\"bottom\" :style=\"{ height: '30%' }\">\n        <van-uploader\n          v-model=\"fileList\"\n          multiple\n          :max-count=\"6\"\n          :after-read=\"afterRead\"\n          class=\"jvideo\"\n          v-if=\"judgeprlic\"\n          :before-read=\"beforeRead\"\n        >\n          <van-cell-group>\n            <van-cell center>\n              <van-button type=\"info\" class=\"picktrue\" >选择照片</van-button>\n            </van-cell>\n          </van-cell-group >\n\n        </van-uploader>\n\n        <van-uploader\n          v-model=\"fileList2\"\n          :after-read=\"afterRead2\"\n          accept=\"video/*\"\n          class=\"jvideo\"\n          v-if=\"judgevideo\"\n          :before-read=\"beforeReadvideo\"\n        >\n          <van-cell-group>\n            <van-cell center>\n              <van-button plain type=\"info\" class=\"picktrue\" >上传视频</van-button>\n              </van-cell>\n          </van-cell-group>\n        </van-uploader>\n      </van-popup>\n       <!-- 图片视频上传--------------------------- -->\n\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"Issues\",\n  data() {\n    return {\n      value: \"\",\n      show: false,\n      fileList: [],\n      fileList2:[], \n      filedata: [],     //图片\n      filevideo:[],     //视频\n      filefalse:[],     //替换\n      http:'',          //图片\n      vurl:'',         //视频地址\n      url:\"../../../assets/imgs/j.png\",\n      judgevideo:true,\n      judgeprlic:true,\n    };\n  },\n  props: {\n    type: String,\n  },\n  methods: {\n\n    //卡死图片\n    beforeRead (file) {\n      let arr;\n      if (!file.length) {\n          arr = [file]\n      } else {\n          arr = file;\n      }\n      console.log(arr[0])\n      if (arr.length > 6) {\n        this.$toast.fail('超出上传数量!')\n        return false;\n      }\n\n      for (let x = 0; x < arr.length; x++) {\n        console.log(arr[x].size );\n        if (arr[x].size > 500 * 1024 *100 *100)  {\n            this.$toast.fail(arr[x].name + ' 图片超出大小');\n            return false;\n        }\n      }\n      return true;\n      \n    },\n\n\n    //卡死视频\n    beforeReadvideo (file) {\n      let arr;\n      if (!file.length) {\n          arr = [file]\n      } else {\n          arr = file;\n      }\n      console.log(arr[0])\n      if (arr[0].size > 500 * 1024 *100 *100 *50) {\n        this.$toast.fail('超出支持的大小')\n        return false;\n      }\n      return true;\n\n    },\n   \n    //返回\n    onClickLeft() {   \n      this.$router.push({\n        path: \"/\",\n      });\n    },\n    onClickRight() {\n      \n      let value = this.value,imgs = this.filedata, video = this.filevideo;\n      \n      this.$axios\n        .post({\n          url: \"/friends/issues\",\n          data: { \n            conter: value,\n            imgs,\n            video\n        }\n        }).then(\n          res => {\n            this.show = false;\n             if (res && res.code && res.code == -21) {\n                this.Toast.fail('请完善个人信息');\n                return;\n            }\n\n            if (res && res.code && res.code == 1) {\n                this.Toast.success('发布成功');\n    \n                this.$router.push({\n                  path:\"/\"\n                })\n            } else {\n                this.Toast.fail('发布失败');\n            }\n          }\n        ) \n\n     \n    },\n    showPopup() {    //显示\n      this.show = true;\n    },\n    afterRead(file) {    //上传图片\n      // 此时可以自行将文件上传至服务器\n      file.status = \"uploading\";\n      file.message = \"上传中...\";\n      this.judgevideo = false;\n      this.judgeprlic = true;\n     \n      const formData = new FormData();\n      if (file.length >= 0) {\n        for (let x = 0; x < file.length; x++) {\n          formData.append(\"file[]\", file[x].file);\n        }\n      } else {\n        formData.append(\"file[]\", file.file);\n      }\n      // formData.append('file[]', file.file);\n      // return;\n\n      this.filefalse = this.fileList; //显示\n      this.fileList = []; //换值\n\n      this.$axios\n        .post({\n          url: \"/friends/ictures\",\n          data: formData,\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n        })\n        .then((res) => {\n          // console.log(\"上传成功\")\n          this.show = false;\n          if (res && res.code && res.code == 1) {\n            file.status = \"done\";\n            file.message = \"上传成功\";\n            this.filedata = [];\n            for (let x = 0; x < res.data.length; x++) {\n              this.filedata.push(res.data[x]);\n              // this.http = 'http://localhost:3000/imgs/temporary' + \"/\" + res.data[x]\n            }\n            // console.log(this.http);\n          } else {\n            this.filefalse = [];\n            this.filedata = [];\n            this.$toast.fail(\"当前图片超出大小\");\n            file.status = \"failed\";\n          }\n        });\n    },\n\n    afterRead2(file) {   //上传视频\n     \n      file.status = \"uploading\";\n      file.message = \"上传中...\";\n      this.judgeprlic = false;\n      this.judgevideo = true;\n      this.$refs.refvideo.style.zIndex = 1;\n\n      const formData = new FormData();\n      if (file.length >= 0) {\n       \n        for (let x = 0; x < file.length; x++) {\n          formData.append(\"file[]\", file[x].file);\n        }\n      } else {\n        formData.append(\"file[]\", file.file);\n      }\n      // formData.append('file[]', file.file);\n      // return;\n\n      this.fileList2 = []; //换值\n\n      this.$axios\n        .post({\n          url: \"/friends/videos\",\n          data: formData,\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n        })\n        .then((res) => {\n          if (res && res.code && res.code == 1) {\n            this.show = false;\n            file.status = \"done\";\n            file.message = \"上传成功\";\n            this.filevideo = [];\n            this.filevideo.push(res.data[0]);\n            this.vurl = require('../../../config').baseURL + '/videos/temporary' + \"/\" + res.data[0]\n            \n            // console.log(this.http);\n            // console.log(this.filedata)\n          } else if (res && res.code && res.code == -3)  {\n            this.$toast.fail(\"视频过大\")\n          }\n        });\n    }\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n \n #issues{\n   background-color: #f8f9fa;\n }\n.content {\n  margin: 2vh;\n  height:50vh;\n  // border: 1px solid rgb(236, 233, 233);\n  background-color: white;\n}\n\n.tit{\n  background-color:transparent;\n  border:none;\n  color:#1989fa;\n  font-size: 1rem;\n}\n\n/deep/ .input_content {\n  border: transparent 1px solid;\n}\n\n/deep/ .transfer{\n  width:5rem;\n  height:5rem;\n  float: left;\n  margin-left: 5px;\n  background:url(\"../../../assets/imgs/j.png\") no-repeat;\n  background-size: 30%;\n  background-position-x: center;\n  background-position-y: center;\n  background-color: #e9ecef;\n  // border: 1px solid red;\n\n}\n\n /deep/ .fliefalse .van-uploader__upload{\n  display: none;\n  padding: 0px;\n  width: 0px;\n  height: 0px;\n}\n\n.picktrue {\n  width: 100%;\n  border-radius: 5rem;\n}\n\n.fliefalse {\n  float: left;\n  margin-left:5px;\n}\n\n/deep/ .fliefalse .van-uploader__upload .van-uploader__upload-icon{\n  font-size: 0px;\n}\n\n.videobox{\n  width:80px;\n  height:80px;\n}\n\n.videobox video{\n  position: relative;\n  top:-80px;\n  left:5px;\n  width:100%;\n  height:100%;\n  object-fit: fill;\n  z-index: -1;\n}\n\n/deep/ .jvideo {\n  width: 100%;\n  margin: 1vh auto;\n}\n\n/deep/ .jvideo div{\n  width: 100%;\n  text-align: center;\n  font-size: 1.1rem;\n  font-weight: bold;\n}\n\n\n/deep/ .van-icon-arrow-left {\n    color:#000;\n    font-size:1rem;\n}\n\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Issues.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Issues.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Issues.vue?vue&type=template&id=4e7e49ab&scoped=true&\"\nimport script from \"./Issues.vue?vue&type=script&lang=js&\"\nexport * from \"./Issues.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Issues.vue?vue&type=style&index=0&id=4e7e49ab&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e7e49ab\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}