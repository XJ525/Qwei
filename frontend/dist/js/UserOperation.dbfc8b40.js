(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["UserOperation"],{4245:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[13==e.$route.params.id?s("div",{staticClass:"btn"},[s("van-nav-bar",{staticClass:"head",attrs:{"left-text":"返回","left-arrow":"",title:"添加用户"},on:{"click-left":e.onClickLeft}}),s("van-field",{attrs:{type:"tel",label:"手机号",placeholder:"请输入手机号"},model:{value:e.tel,callback:function(t){e.tel=t},expression:"tel"}}),s("van-cell-group",[s("van-field",{attrs:{label:"姓名",maxlength:"20",placeholder:"请输入真实姓名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),s("van-field",{attrs:{name:"radio",label:"性别"},scopedSlots:e._u([{key:"input",fn:function(){return[s("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.sexvalue,callback:function(t){e.sexvalue=t},expression:"sexvalue"}},[s("van-radio",{attrs:{name:"1"}},[e._v("男")]),s("van-radio",{attrs:{name:"2"}},[e._v("女")])],1)]},proxy:!0}],null,!1,4006881931)}),s("van-field",{attrs:{readonly:"",clickable:"",name:"picker",value:e.value,label:"选择角色",placeholder:"点击选择角色"},on:{click:function(t){e.showPicker=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:e.columns},on:{confirm:e.onConfirm,cancel:function(t){e.showPicker=!1}}})],1),s("van-field",{attrs:{readonly:"",clickable:"",name:"picker",value:e.values,label:"选择部门",placeholder:"点击选择部门"},on:{click:function(t){e.showPickers=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showPickers,callback:function(t){e.showPickers=t},expression:"showPickers"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:e.list},on:{confirm:e.onConfirms,cancels:function(t){e.showPickers=!1}}})],1),s("van-cell",{attrs:{title:"选择入职时间",value:e.date},on:{click:function(t){e.showtime=!0}}}),s("van-calendar",{attrs:{"min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onConfirmss},model:{value:e.showtime,callback:function(t){e.showtime=t},expression:"showtime"}}),""!=e.value&&""!=e.values&&""!=e.username&&""!=e.tel&&""!=e.date?s("van-button",{staticClass:"btnsubmit",attrs:{type:"info"},on:{click:e.submits}},[e._v("提交")]):s("van-button",{staticClass:"btnsubmit",attrs:{type:"info",disabled:""},on:{click:e.submits}},[e._v("提交")])],1):14==e.$route.params.id?s("div",{staticClass:"btn"},[s("van-nav-bar",{staticClass:"head",attrs:{"left-text":"返回","left-arrow":"",title:"冻结用户"},on:{"click-left":e.onClickLeft}}),s("van-field",{attrs:{type:"text",label:"用户ID",placeholder:"请输入用户ID"},model:{value:e.powerid,callback:function(t){e.powerid=t},expression:"powerid"}}),s("van-field",{attrs:{name:"radio",label:"操作"},scopedSlots:e._u([{key:"input",fn:function(){return[s("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.sexvalue,callback:function(t){e.sexvalue=t},expression:"sexvalue"}},[s("van-radio",{attrs:{name:"1"}},[e._v("冻结")]),s("van-radio",{attrs:{name:"2"}},[e._v("解冻")])],1)]},proxy:!0}])}),""!=e.powerid?s("van-button",{staticClass:"sub",attrs:{type:"info"},on:{click:e.submits}},[e._v("执行")]):s("van-button",{staticClass:"sub",attrs:{type:"info",disabled:""},on:{click:e.submits}},[e._v("执行")])],1):5==e.$route.params.id?s("div",[s("van-nav-bar",{staticClass:"head",attrs:{"left-text":"返回","left-arrow":"",title:"删除角色"},on:{"click-left":e.onClickLeft}}),s("van-field",{attrs:{readonly:"",clickable:"",name:"picker",value:e.value,label:"选择角色",placeholder:"点击选择角色"},on:{click:function(t){e.showPicker=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:e.columns},on:{confirm:e.onConfirm,cancel:function(t){e.showPicker=!1}}})],1),""!=e.value?s("van-button",{staticClass:"sub",attrs:{type:"info"},on:{click:e.submits}},[e._v("删除角色")]):s("van-button",{staticClass:"sub",attrs:{type:"info",disabled:""},on:{click:e.submits}},[e._v("删除角色")])],1):e._e()])},i=[],a=(s("7734"),{data(){return{show:"",showtitle:"",result:[],list:[],checked:!0,select:[],option:"",powerid:"",showcontent:!1,showsub:"",radio:"",value:"",columns:[],showPicker:!1,username:"",tel:"",values:"",showPickers:!1,sexvalue:"1",date:"",showtime:!1,list_department_id:{},columns_role_id:{},role_id:"",power_obj:{},role_power:{},minDate:new Date(2020,0,1),maxDate:new Date,depart_id:""}},methods:{toggle(e){this.$refs.checkboxes[e].toggle()},onClickLeft(){this.$router.push({path:"/about"})},onConfirm(e){this.value=e,this.showPicker=!1},onConfirms(e){this.values=e,this.showPickers=!1;for(let t in this.list_department_id)this.list_department_id[t]==e&&(this.depart_id=t)},onConfirmRole(e){this.value=e,this.showPicker=!1;for(let t in this.columns_role_id)this.columns_role_id[t]==this.value&&(this.role_id=t);this.$axios.get({url:"/role/permissions",params:{rid:this.role_id}}).then(e=>{e instanceof Array&&console.log(e),e&&e.code&&"-2"==e.code&&console.log("角色不存在")})},checkAll(){this.$refs.checkboxGroup.toggleAll(!0)},toggleAll(){this.$refs.checkboxGroup.toggleAll()},formatDate(e){return`${e.getFullYear()}-${Number(e.getMonth()+1)}-${e.getDate()}`},onConfirmss(e){this.showtime=!1,this.date=this.formatDate(e)},submits(){switch(this.$route.params.id){case"4":this.showtitle="新建角色",this.Toast.loading({message:"创建中...",forbidClick:!0}),this.$axios.post({url:"/role/add",data:{roleName:this.value,roleids:"["+String(this.result)+"]"}}).then(e=>{"0"==e.code?(this.Toast.success("创建成功"),this.$router.push({path:"/about"})):this.Toast.fail("创建失败")});break;case"6":this.showtitle="查询权限",this.$axios.post({url:"/role/find",data:{roleid:this.powerid}}).then(e=>{e.roleid?(this.showsub=e.role_name,this.showcontent=!0):e&&"-3"==e.code?this.Toast.fail("未查询到该权限"):this.Toast.fail("查询失败")});break;case"13":let e=0,t=0;for(let s in this.columns_role_id)this.columns_role_id[s]==this.value&&(e=s);for(let s in this.columns_role_id)this.list_department_id[s]==this.values&&(t=s);this.$axios.post({url:"/user/add",data:{phone:this.tel,rid:e,username:this.username,sex:this.sexvalue,induction_time:new Date(this.date).getTime(),department_id:this.depart_id}}).then(e=>{console.log(e),"0"==e.code?(this.Toast.success("添加成功"),this.$router.push({path:"/about"})):"-21"==e.code?this.Toast.fail("手机号已存在"):"-20"==e.code?this.Toast.fail("请输入正确的手机号"):this.Toast.fail("添加失败,请重试")});break;case"14":this.$axios.post({url:"/user/freeze",data:{uid:"["+this.powerid+"]",option:this.sexvalue}}).then(e=>{"0"==e.code?(this.Toast.success("操作成功"),this.$router.push({path:"/about"})):this.Toast.fail("操作失败，请重试"),console.log(e)});case"11":for(let s in this.columns_role_id)this.columns_role_id[s]==this.value&&(this.role_id=s);console.log(this.role_id);break;case"5":this.Dialog.confirm({title:"删除角色",message:"确认删除？删除操作不可逆！！！"}).then(()=>{this.Toast.loading({message:"删除中...",forbidClick:!0});for(let e in this.columns_role_id)this.columns_role_id[e]==this.value&&(this.role_id=e);this.$axios.get({url:"/role/del",params:{roleid:this.role_id}}).then(e=>{"0"==e.code?(this.Toast.success("删除成功"),this.$router.push({path:"/about"})):"-3"==e.code?this.Toast.fail("该角色不存在"):this.Toast.fail("删除失败")})}).catch(()=>{this.Toast({message:"已取消",position:"bottom"})});break;case"7":}}},mounted(){switch(this.$route.params.id){case"4":this.showtitle="创建角色",this.$axios.get({url:"/role/select"}).then(e=>{this.option=e,console.log(e)});break;case"13":this.$axios.get({url:"/role/select_role"}).then(e=>{this.select=e,e.forEach(e=>{this.columns.push(e.role_name),this.columns_role_id[e.roleid]=e.role_name})}),this.$axios.get({url:"/department/select"}).then(e=>{let t=[],s={};e.forEach(e=>{t.push(e.name),s[e.department_id]=e.name}),this.list=t,this.list_department_id=s,console.log(this.list_department_id)});break;case"11":this.$axios.get({url:"/role/select_role"}).then(e=>{this.select=e,e.forEach(e=>{this.columns.push(e.role_name),this.columns_role_id[e.roleid]=e.role_name})});break;case"5":this.$axios.get({url:"/role/select_role"}).then(e=>{this.select=e,e.forEach(e=>{this.columns.push(e.role_name),this.columns_role_id[e.roleid]=e.role_name}),console.log(this.columns)});break;case"15":this.$axios.get({url:"/department/select"}).then(e=>{console.log(e)});break;case"7":this.$axios.get({url:"/role/select_role"}).then(e=>{this.select=e,e.forEach(e=>{this.columns.push(e.role_name),this.columns_role_id[e.roleid]=e.role_name})}),this.$axios.get({url:"/role/select"}).then(e=>{this.list=e,e.forEach((e,t)=>{this.result.push(e.pname),this.power_obj[t][e.pid]=e.pname}),console.log(this.power_obj)})}}}),l=a,n=(s("c10f"),s("2877")),r=Object(n["a"])(l,o,i,!1,null,"4a2af14e",null);t["default"]=r.exports},7734:function(e,t,s){"use strict";t["a"]={checkPhone(e){return!!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e)},stampChangehHonurs:function(){let e=(new Date).getHours(),t=(new Date).getMinutes(),s=(new Date).getSeconds();return`${this.add0(e)}:${this.add0(t)}:${this.add0(s)}`},add0(e){return e<10?"0"+e:e},timeChangeDate(e){let t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}}},c10f:function(e,t,s){"use strict";s("d7d7")},d7d7:function(e,t,s){}}]);
//# sourceMappingURL=UserOperation.dbfc8b40.js.map