(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Issues"],{"431d":function(e,t,s){},5417:function(e,t,s){"use strict";s("431d")},"9b39":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"issues"}},[s("van-nav-bar",{attrs:{title:"分享","left-text":"返回","left-arrow":""},on:{"click-left":e.onClickLeft},scopedSlots:e._u([{key:"right",fn:function(){return[s("van-button",{staticClass:"tit",attrs:{type:"primary",size:"mini"},on:{click:e.onClickRight}},[e._v("发表")])]},proxy:!0}])}),s("div",{staticClass:"content"},[s("van-cell-group",{attrs:{rows:"5"}},[s("van-field",{staticClass:"input_content",attrs:{type:"textarea",rows:"5",maxlength:"200",placeholder:"请输入你的内容",spellcheck:"false","show-word-limit":""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),s("van-uploader",{staticClass:"fliefalse",model:{value:e.filefalse,callback:function(t){e.filefalse=t},expression:"filefalse"}}),s("van-cell",{staticClass:"transfer",on:{click:e.showPopup}}),s("div",{staticClass:"videobox"},[s("video",{ref:"refvideo",attrs:{src:e.vurl}})]),s("van-popup",{style:{height:"30%"},attrs:{position:"bottom"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e.judgeprlic?s("van-uploader",{staticClass:"jvideo",attrs:{multiple:"","max-count":6,"after-read":e.afterRead,"before-read":e.beforeRead},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},[s("van-cell-group",[s("van-cell",{attrs:{center:""}},[s("van-button",{staticClass:"picktrue",attrs:{type:"info"}},[e._v("选择照片")])],1)],1)],1):e._e(),e.judgevideo?s("van-uploader",{staticClass:"jvideo",attrs:{"after-read":e.afterRead2,accept:"video/*","before-read":e.beforeReadvideo},model:{value:e.fileList2,callback:function(t){e.fileList2=t},expression:"fileList2"}},[s("van-cell-group",[s("van-cell",{attrs:{center:""}},[s("van-button",{staticClass:"picktrue",attrs:{plain:"",type:"info"}},[e._v("上传视频")])],1)],1)],1):e._e()],1)],1)],1)},a=[],l=(s("bc3a"),{name:"Issues",data(){return{value:"",show:!1,fileList:[],fileList2:[],filedata:[],filevideo:[],filefalse:[],http:"",vurl:"",url:"../../../assets/imgs/j.png",judgevideo:!0,judgeprlic:!0}},props:{type:String},methods:{beforeRead(e){let t;if(t=e.length?e:[e],console.log(t[0]),t.length>6)return this.$toast.fail("超出上传数量!"),!1;for(let s=0;s<t.length;s++)if(console.log(t[s].size),t[s].size>512e7)return this.$toast.fail(t[s].name+" 图片超出大小"),!1;return!0},beforeReadvideo(e){let t;return t=e.length?e:[e],console.log(t[0]),!(t[0].size>256e9)||(this.$toast.fail("超出支持的大小"),!1)},onClickLeft(){this.$router.push({path:"/"})},onClickRight(){let e=this.value,t=this.filedata,s=this.filevideo;this.$axios.post({url:"/friends/issues",data:{conter:e,imgs:t,video:s}}).then(e=>{this.show=!1,e&&e.code&&-21==e.code?this.Toast.fail("请完善个人信息"):e&&e.code&&1==e.code?(this.Toast.success("发布成功"),this.$router.push({path:"/"})):this.Toast.fail("发布失败")})},showPopup(){this.show=!0},afterRead(e){e.status="uploading",e.message="上传中...",this.judgevideo=!1,this.judgeprlic=!0;const t=new FormData;if(e.length>=0)for(let s=0;s<e.length;s++)t.append("file[]",e[s].file);else t.append("file[]",e.file);this.filefalse=this.fileList,this.fileList=[],this.$axios.post({url:"/friends/ictures",data:t,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{if(this.show=!1,t&&t.code&&1==t.code){e.status="done",e.message="上传成功",this.filedata=[];for(let e=0;e<t.data.length;e++)this.filedata.push(t.data[e])}else this.filefalse=[],this.filedata=[],this.$toast.fail("当前图片超出大小"),e.status="failed"})},afterRead2(e){e.status="uploading",e.message="上传中...",this.judgeprlic=!1,this.judgevideo=!0,this.$refs.refvideo.style.zIndex=1;const t=new FormData;if(e.length>=0)for(let s=0;s<e.length;s++)t.append("file[]",e[s].file);else t.append("file[]",e.file);this.fileList2=[],this.$axios.post({url:"/friends/videos",data:t,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{t&&t.code&&1==t.code?(this.show=!1,e.status="done",e.message="上传成功",this.filevideo=[],this.filevideo.push(t.data[0]),this.vurl=s("f121").baseURL+"/videos/temporary/"+t.data[0]):t&&t.code&&-3==t.code&&this.$toast.fail("视频过大")})}}}),o=l,n=(s("5417"),s("2877")),r=Object(n["a"])(o,i,a,!1,null,"4e7e49ab",null);t["default"]=r.exports}}]);
//# sourceMappingURL=Issues.24a19233.js.map