{"version":3,"sources":["webpack:///./src/untils/index.js","webpack:///./src/views/myshow/Msg.vue?c01e","webpack:///./src/views/myshow/Msg.vue?90fe","webpack:///src/views/myshow/Msg.vue","webpack:///./src/views/myshow/Msg.vue?86e0","webpack:///./src/views/myshow/Msg.vue"],"names":["checkPhone","phone","test","stampChangehHonurs","hou","Date","getHours","min","getMinutes","sec","getSeconds","this","add0","m","timeChangeDate","time","times","getFullYear","getMonth","getDate","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","onClickLeft","scopedSlots","_u","key","fn","afterRead","readonlys","model","value","callback","$$v","fileList","expression","proxy","username","nickname","sex","_e","address","induction_time","signature","email","updata_msg","_v","complete_msg","staticRenderFns","result","avatar_url","user_head_url","uese_img","methods","$router","push","path","file","formData","FormData","append","$axios","console","log","Toast","loading","message","forbidClick","duration","position","component"],"mappings":"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","file":"js/Msg.8ca11332.js","sourcesContent":["export default {\n    checkPhone(phone) { \n        if(!(/^1(3|4|5|6|7|8|9)\\d{9}$/.test(phone))){ \n            return false; \n        } \n        return true;\n    },\n    stampChangehHonurs: function () {\n      let hou = new Date().getHours();\n      let min = new Date().getMinutes();\n      let sec = new Date().getSeconds();\n      return `${this.add0(hou)}:${this.add0(min)}:${this.add0(sec)}`;\n    },\n    add0 (m) { return m < 10 ? '0' + m : m },\n    timeChangeDate(time) {\n        let times = new Date(time);\n        return `${times.getFullYear()}-${times.getMonth() + 1}-${times.getDate()}`\n    },\n    \n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Msg.vue?vue&type=style&index=0&id=57e39711&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mymsg\"},[_c('div',{staticClass:\"head\"},[_c('van-nav-bar',{staticClass:\"nav\",attrs:{\"title\":\"我的资料\",\"left-arrow\":\"\",\"size\":\"18\"},on:{\"click-left\":_vm.onClickLeft}})],1),_c('div',{staticClass:\"content\"},[_c('van-cell-group',{attrs:{\"title\":\" \"}},[_c('van-field',{staticClass:\"head_img\",attrs:{\"name\":\"uploader\",\"label\":\"头像\"},scopedSlots:_vm._u([{key:\"input\",fn:function(){return [_c('van-uploader',{attrs:{\"after-read\":_vm.afterRead,\"max-count\":1,\"readonly\":_vm.readonlys},model:{value:(_vm.fileList),callback:function ($$v) {_vm.fileList=$$v},expression:\"fileList\"}})]},proxy:true}])}),_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"姓名\",\"readonly\":\"\"},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}}),_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"昵称\",\"readonly\":_vm.readonlys,\"maxlength\":\"6\"},model:{value:(_vm.nickname),callback:function ($$v) {_vm.nickname=$$v},expression:\"nickname\"}}),(_vm.sex == 1)?_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"性别\",\"value\":\"男\",\"readonly\":\"\"}}):_vm._e(),(_vm.sex == 2)?_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"性别\",\"value\":\"女\",\"readonly\":\"\"}}):_vm._e(),_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"地址\",\"readonly\":_vm.readonlys},model:{value:(_vm.address),callback:function ($$v) {_vm.address=$$v},expression:\"address\"}}),_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"入职时间\",\"readonly\":\"\"},model:{value:(_vm.induction_time),callback:function ($$v) {_vm.induction_time=$$v},expression:\"induction_time\"}}),_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"个性签名\",\"readonly\":_vm.readonlys},model:{value:(_vm.signature),callback:function ($$v) {_vm.signature=$$v},expression:\"signature\"}}),_c('van-field',{staticClass:\"updata_read\",attrs:{\"label\":\"邮箱\",\"readonly\":_vm.readonlys},model:{value:(_vm.email),callback:function ($$v) {_vm.email=$$v},expression:\"email\"}})],1),(_vm.readonlys == true)?_c('van-button',{staticClass:\"ifobtn\",attrs:{\"type\":\"info\"},on:{\"click\":_vm.updata_msg}},[_vm._v(\"修改信息\")]):_c('van-button',{staticClass:\"ifobtn\",attrs:{\"type\":\"info\",\"plain\":\"\"},on:{\"click\":_vm.complete_msg}},[_vm._v(\"修改完成\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"mymsg\">\n    <!-- 头部 -->\n    <div class=\"head\">\n      <van-nav-bar\n        title=\"我的资料\"\n        left-arrow\n        class=\"nav\"\n        size=\"18\"\n        @click-left=\"onClickLeft\"\n      />\n    </div>\n    <!-- 信息 -->\n    <div class=\"content\">\n      <van-cell-group title=\" \">\n        <van-field name=\"uploader\" class=\"head_img\" label=\"头像\">\n          <template #input>\n            <van-uploader\n              v-model=\"fileList\"\n              :after-read=\"afterRead\"\n              :max-count=\"1\"\n              :readonly=\"readonlys\"\n            />\n          </template>\n        </van-field>\n\n        <van-field\n          label=\"姓名\"\n          class=\"updata_read\"\n          v-model=\"username\"\n          readonly\n        />\n\n        <van-field\n          label=\"昵称\"\n          class=\"updata_read\"\n          v-model=\"nickname\"\n          :readonly=\"readonlys\"\n          maxlength=\"6\"\n        />\n\n        <van-field\n          label=\"性别\"\n          class=\"updata_read\"\n          v-if=\"sex == 1\"\n          value=\"男\"\n          readonly\n        />\n        <van-field\n          label=\"性别\"\n          class=\"updata_read\"\n          v-if=\"sex == 2\"\n          value=\"女\"\n          readonly\n        />\n\n        <van-field\n          label=\"地址\"\n          class=\"updata_read\"\n          v-model=\"address\"\n          :readonly=\"readonlys\"\n        />\n\n        <van-field\n          label=\"入职时间\"\n          class=\"updata_read\"\n          v-model=\"induction_time\"\n          readonly\n        />\n        <van-field\n          label=\"个性签名\"\n          class=\"updata_read\"\n          v-model=\"signature\"\n          :readonly=\"readonlys\"\n        />\n        <van-field\n          label=\"邮箱\"\n          class=\"updata_read\"\n          v-model=\"email\"\n          :readonly=\"readonlys\"\n        />\n      </van-cell-group>\n\n      <van-button\n        v-if=\"readonlys == true\"\n        class=\"ifobtn\"\n        type=\"info\"\n        @click=\"updata_msg\"\n        >修改信息</van-button\n      >\n      <van-button v-else type=\"info\" class=\"ifobtn\" plain @click=\"complete_msg\"\n        >修改完成</van-button\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport untils from \"../../untils\";\nexport default {\n  data() {\n    return {\n      username: \"\",\n      nickname: \"\",\n      sex: \"\",\n      address: \"\",\n      induction_time: \"\",\n      signature: \"\",\n      email: \"\",\n      fileList: [],\n      readonlys: true,\n      result: \"\",\n      avatar_url: \"\",\n      user_head_url: \"\",\n      uese_img: \"\",\n    };\n  },\n  methods: {\n    onClickLeft() {\n      this.$router.push({\n        path: \"/myshow\",\n      });\n    },\n\n    afterRead(file) {\n      // 此时可以自行将文件上传至服务器\n\n      const formData = new FormData();\n      formData.append(\"file\", file.file);\n\n      this.$axios\n        .post({\n          url: \"/friends/ictures\",\n          data: formData,\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n        })\n        .then((res) => {\n          if (res.code == 1) {\n            // 上传头像成功  //图片地址\n            this.user_head_url = res.data[0];\n            let imgs = require('../../config').baseURL + \"/imgs/temporary/\" + res.data[0];\n\n            //更新数据库信息\n          }\n        });\n    },\n\n    updata_msg() {\n      console.log(\"修改信息\");\n      this.readonlys = false;\n    },\n\n    complete_msg() {\n      console.log(\"完成修改\");\n      console.log(this.user_head_url);\n\n      \n      //判断信息是否修改\n      if (\n        this.result.address != this.address ||\n        this.result.nickname != this.nickname ||\n        this.result.signature != this.signature ||\n        this.result.email != this.email ||\n        this.result.user_head_url != this.user_head_url\n      ) {\n        //已经修改  请求\n        this.Toast.loading({\n          message: \"修改中...\",\n          forbidClick: true,\n          duration: 0,\n        });\n        \n        this.$axios\n          .post({\n            url: \"/user/upmessage\",\n            data: {\n              nickname: this.nickname,\n              address: this.address,\n              signature: this.signature,\n              email: this.email,\n              headimg: this.user_head_url,\n            },\n          })\n          .then((res) => {\n            this.Toast.clear();\n            if (res.code == \"0\") {\n              this.Toast.success(\"修改成功\");\n              this.$router.push({\n                path: \"/myshow\",\n              });\n            } else if (res.code == \"-2\" || res.code == \"-3\") {\n              this.Toast.fail(\"数据格式有误，请检查数据是否补充完整\");\n              this.readonlys = false;\n            } else {\n              this.Toast.fail(\"修改失败\");\n              this.readonlys = false;\n            }\n          });\n      } else {\n        //未修改\n        this.Toast({\n          message: \"并未修改任何信息\",\n          position: \"bottom\",\n        });\n      }\n      this.readonlys = true;\n    },\n  },\n  mounted() {\n    // console.log(this.fileList);\n    //\n    this.$axios\n      .get({\n        url: \"/user/mymessage\",\n      })\n      .then((res) => {\n        this.result = res.message;\n        console.log(res);\n        if (res.code == \"1\") {\n          this.username = res.message.username;\n          this.nickname = res.message.nickname;\n          this.sex = res.message.sex;\n          this.address = res.message.address;\n          this.email = res.message.email;\n          this.user_head_url = res.message.user_head_url;\n          this.induction_time = untils.timeChangeDate(\n            res.message.induction_time\n          );\n          this.signature = res.message.signature;\n          let user_head_url = res.message.user_head_url ? res.message.user_head_url : 'head.png'\n          this.uese_img =\n            require('../../config').baseURL + \"/imgs/temporary/\" + user_head_url;\n\n          this.fileList = [\n            {\n              url: this.uese_img,\n            },\n          ];\n          this.Toast.clear();\n          //请求成功\n        } else if (res.code == \"-6\") {\n          this.Toast.fail(\"未获取到您的信息\");\n          //未请求到数据，该用户不存在\n          return;\n        } else if (res.code == \"-2\") {\n          this.Toast.fail(\"未获取到数据,请重试\");\n          //请求失败\n          return;\n        } else if (res.code == \"-500\") {\n          //异地登陆\n          return;\n        }\n      });\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.mymsg {\n  height: 100vh;\n}\n\n.nav {\n  height: 7vh;\n}\n\n\n\n/deep/ .van-icon-arrow-left {\n    color:#000;\n    font-size:1rem;\n}\n\n.head {\n  .nav {\n    font-size: 1rem;\n  }\n}\n.content {\n  width: 95%;\n  margin: 0 auto;\n  text-align: center;\n\n  .updata_read {\n    padding-top: 1rem;\n    font-size: 1rem;\n  }\n\n  .head_img {\n    font-size: 1rem;\n  }\n\n  .ifobtn {\n    width: 90%;\n    margin: 1rem auto;\n    border-radius: 4rem;\n    font-size: 1rem;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Msg.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Msg.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Msg.vue?vue&type=template&id=57e39711&scoped=true&\"\nimport script from \"./Msg.vue?vue&type=script&lang=js&\"\nexport * from \"./Msg.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Msg.vue?vue&type=style&index=0&id=57e39711&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57e39711\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}