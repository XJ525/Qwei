(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AddUsers"],{"496a":function(e,t,s){},e271:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"btn"},[s("van-nav-bar",{staticClass:"head",attrs:{"left-text":"返回","left-arrow":"",title:"添加用户"},on:{"click-left":e.onClickLeft}}),s("van-field",{attrs:{type:"tel",label:"手机号",placeholder:"请输入手机号"},model:{value:e.tel,callback:function(t){e.tel=t},expression:"tel"}}),s("van-cell-group",[s("van-field",{attrs:{label:"姓名",maxlength:"20",placeholder:"请输入真实姓名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),s("van-field",{attrs:{name:"radio",label:"性别"},scopedSlots:e._u([{key:"input",fn:function(){return[s("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.sexvalue,callback:function(t){e.sexvalue=t},expression:"sexvalue"}},[s("van-radio",{attrs:{name:"1"}},[e._v("男")]),s("van-radio",{attrs:{name:"2"}},[e._v("女")])],1)]},proxy:!0}])}),s("van-field",{attrs:{readonly:"",clickable:"",name:"picker",value:e.value,label:"角色",placeholder:"点击选择角色"},on:{click:function(t){e.showPicker=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:e.columns},on:{confirm:e.onConfirm,cancel:function(t){e.showPicker=!1}}})],1),s("van-field",{attrs:{readonly:"",clickable:"",name:"picker",value:e.values,label:"部门",placeholder:"点击选择部门"},on:{click:function(t){e.showPickers=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showPickers,callback:function(t){e.showPickers=t},expression:"showPickers"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:e.list},on:{confirm:e.onConfirms,cancels:function(t){e.showPickers=!1}}})],1),s("van-cell",{attrs:{title:"入职时间",value:e.date},on:{click:function(t){e.showtime=!0}}}),s("van-calendar",{attrs:{color:"#1989fa","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onConfirmss},model:{value:e.showtime,callback:function(t){e.showtime=t},expression:"showtime"}}),""!=e.tel&&""!=e.username&&""!=e.sexvalue&&""!=e.value&&""!=e.values&&""!=e.date?s("van-button",{staticClass:"sub",attrs:{type:"info"},on:{click:e.submits}},[e._v("提交")]):s("van-button",{staticClass:"sub",attrs:{type:"info",disabled:""},on:{click:e.submits}},[e._v("提交")])],1)])},i=[],a={data(){return{show:"",showtitle:"",result:[],list:[],checked:!0,select:[],option:"",powerid:"",showcontent:!1,showsub:"",radio:"",value:"",columns:[],showPicker:!1,username:"",tel:"",values:"",showPickers:!1,sexvalue:"1",date:"",showtime:!1,list_department_id:{},columns_role_id:{},role_id:"",power_obj:{},role_power:{},minDate:new Date(2020,0,1),maxDate:new Date,depart_id:""}},methods:{toggle(e){this.$refs.checkboxes[e].toggle()},onClickLeft(){this.$router.push({path:"/about/user"})},onConfirm(e){this.value=e,this.showPicker=!1},onConfirms(e){this.values=e,this.showPickers=!1;for(let t in this.list_department_id)this.list_department_id[t]==e&&(this.depart_id=t)},onConfirmRole(e){this.value=e,this.showPicker=!1;for(let t in this.columns_role_id)this.columns_role_id[t]==this.value&&(this.role_id=t);this.$axios.get({url:"/role/permissions",params:{rid:this.role_id}}).then(e=>{e instanceof Array&&console.log(e),e&&e.code&&"-2"==e.code&&console.log("角色不存在")})},checkAll(){this.$refs.checkboxGroup.toggleAll(!0)},toggleAll(){this.$refs.checkboxGroup.toggleAll()},formatDate(e){return`${e.getFullYear()}-${Number(e.getMonth()+1)}-${e.getDate()}`},onConfirmss(e){this.showtime=!1,this.date=this.formatDate(e)},submits(){if(""==this.username.trim())return void this.Toast({message:"用户名不能未空",position:"bottom"});let e=0,t=0;for(let s in this.columns_role_id)this.columns_role_id[s]==this.value&&(e=s);for(let s in this.columns_role_id)this.list_department_id[s]==this.values&&(t=s);this.$axios.post({url:"/user/add",data:{phone:this.tel,rid:e,username:this.username,sex:this.sexvalue,induction_time:new Date(this.date).getTime(),department_id:this.depart_id}}).then(e=>{console.log(e),"0"==e.code?(this.Toast.success("添加成功"),setTimeout(()=>{this.$router.push({path:"/about/user"})},1e3)):"-21"==e.code?this.Toast.fail("手机号已存在"):"-20"==e.code?this.Toast.fail("请输入正确的手机号"):this.Toast.fail("添加失败,请重试")})}},mounted(){this.$axios.get({url:"/role/select_role"}).then(e=>{this.select=e,console.log(e),e instanceof Array&&e.forEach(e=>{this.columns.push(e.role_name),this.columns_role_id[e.roleid]=e.role_name})}),this.$axios.get({url:"/department/select"}).then(e=>{let t=[],s={};e instanceof Array&&(e.forEach(e=>{t.push(e.name),s[e.department_id]=e.name}),this.list=t,this.list_department_id=s,console.log(this.list_department_id))})}},l=a,n=(s("e416"),s("2877")),r=Object(n["a"])(l,o,i,!1,null,"746d0e1a",null);t["default"]=r.exports},e416:function(e,t,s){"use strict";s("496a")}}]);
//# sourceMappingURL=AddUsers.6eca9252.js.map