(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Altermanagement"],{"2afc":function(t,e,a){"use strict";a("5b7f")},"5b7f":function(t,e,a){},"79b0":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"altermanagement"},[a("van-nav-bar",{attrs:{title:"更改部门","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),a("van-popup",{style:{height:"60%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("van-picker",{attrs:{title:"请选择","show-toolbar":"",columns:t.columns},on:{confirm:t.onConfirm,cancel:t.onCancel,change:t.onChange}})],1),a("van-form",{on:{submit:t.onSubmit}},[a("van-field",{attrs:{name:"department",label:"部门",placeholder:"部门",rules:[{required:!0,message:"请填写要更改的部门"}]},model:{value:t.department,callback:function(e){t.department=e},expression:"department"}}),a("van-cell",{attrs:{title:"负责人","is-link":"",center:!0,"arrow-direction":"down",required:!0,value:t.puser},on:{click:t.showPopup}}),a("div",{staticStyle:{margin:"16px"}},[a("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("提交")])],1)],1)],1)},s=[],i={name:"Altermanagement",data(){return{department:"",principal:"",show:!1,columns:[],alluser:[],principalval:"",departmentid:"",puser:"请选择"}},async mounted(){await this.$axios.get({url:"/department/selectuser"}).then(t=>{console.log(t),this.alluser=t;for(let e=0;e<t.length;e++)this.columns.push(t[e].username)});let t=this.$route.params,e=this.alluser;for(let a=0;a<e.length;a++)e[a].user_id==t.uid&&(this.puser=e[a].username,this.department=t.name,this.departmentid=t.departmentid,this.principalval=t.uid)},methods:{onSubmit(t){this.$axios.post({url:"/department/update",data:{department_id:this.departmentid,name:t.department,head_id:this.principalval}}).then(t=>{t&&t.code&&0==t.code&&(this.Toast.success("更改成功"),this.$router.replace("/departmentadmin")),t&&t.code&&0!=t.code&&this.Toast.fail("更改失败")})},showPopup(){this.show=!0},onConfirm(t,e){this.show=!1,this.puser=t;for(let a=0;a<this.alluser.length;a++)t==this.alluser[a]["username"]&&(this.principal=this.alluser[a]["username"],this.principalval=this.alluser[a]["user_id"])},onChange(t,e,a){this.$toast("当前选择："+e),this.puser=e},onCancel(t,e,a){this.show=!1},onClickLeft(){this.$router.push({path:"/departmentadmin"})}}},r=i,l=(a("2afc"),a("2877")),o=Object(l["a"])(r,n,s,!1,null,"48b0e288",null);e["default"]=o.exports}}]);
//# sourceMappingURL=Altermanagement.684840a2.js.map